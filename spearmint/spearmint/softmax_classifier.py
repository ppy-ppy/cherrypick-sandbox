import numpy as np

terasort_IO_Measure_Weight=0.009540942072020178
terasort_CPU_Measure_Weight= 0.14066129705296707
testdfsio_IO_Measure_Weight=0.15623950104945042
testdfsio_CPU_Measure_Weight= 0.10161307628457145
tpcds_IO_Measure_Weight=0
tpcds_CPU_Measure_Weight=0.38452526390607106
spark_IO_Measure_Weight=0
spark_CPU_Measure_Weight= 0
kmeans_IO_Measure_Weight=0.020921961033963814
kmeans_CPU_Measure_Weight= 0.3810012342455749

w_input_hidden=[[ -6.66248501e-02,   1.01387411e-01,  -2.15783652e-02,
          2.49421906e-01,  -7.36005166e-02,   1.50656072e-01,
         -5.01506901e-02,   1.73339282e-01,   9.39635189e-02,
         -2.92462712e-02,   1.60318010e-01,   1.32042024e-01,
          8.85753301e-03,   2.52161674e-01,   1.52943118e-01,
          2.81697094e-03,   8.04391358e-02,   5.74171535e-02,
          1.02957028e-02,   9.24759056e-02,   7.87850300e-02,
          5.68403926e-02,   2.45004821e-01,   4.02103413e-02,
          1.73098907e-01,   7.50942997e-02,  -1.92865597e-02,
          1.70585825e-01,  -4.87896297e-02,   1.61268507e-01,
          1.32641835e-01,   2.40108166e-01,   1.24686069e-01,
          1.87407382e-01,  -2.47924103e-03,   2.08799129e-01,
          6.08551973e-02,  -2.00731772e-02,   1.54420608e-01,
          2.00477887e-01,  -3.41333394e-02,   2.29669036e-01,
          4.48524036e-02,  -3.43627926e-02,   2.72652607e-01,
          1.19090254e-01,   1.96726155e-01,   1.09699846e-01,
          2.09814745e-01,  -1.34028502e-02,  -6.32211498e-03,
         -1.96929245e-02,   2.33576327e-01,   1.92697574e-01,
          9.36672350e-02,  -1.29748937e-02,   1.57187681e-01,
          3.01843610e-02,  -4.25325368e-02,   1.70296641e-01,
          2.23535733e-01,  -5.83946357e-02,   1.54725651e-01,
          2.66118675e-01,   1.41235477e-01,   2.34323847e-01,
          1.82315094e-01,  -4.01199705e-02,  -5.17597801e-02,
          8.95373625e-02,   1.83092496e-02,   7.10733992e-02,
          1.22290873e-01,   1.99585619e-01,   1.97717088e-01,
         -6.77307312e-03,   1.33104521e-01,   2.05638171e-01,
          1.48816266e-01,   2.86819319e-01,  -4.91910246e-02,
          1.85177885e-01,   2.74327459e-01,   1.77155699e-01,
          1.91916042e-01,   1.82815987e-01,  -1.26557030e-02,
         -1.67369713e-02,  -5.88302120e-02,   2.56548199e-01,
          1.70351776e-01,   1.95502628e-01,  -1.92422557e-02,
          2.92671362e-01,   1.45405308e-01,   3.35592477e-02,
          4.52126448e-02,  -3.48367107e-02,   5.02148524e-02,
         -6.74920107e-02],
       [  6.25499905e-01,   1.55851926e-02,   3.98733574e-01,
         -2.46961300e-01,   6.97415875e-01,  -7.39409504e-02,
          5.35398050e-01,   7.67595419e-03,  -5.12490441e-02,
          4.64675447e-01,   1.67383073e-02,  -7.34641426e-02,
          2.52967803e-01,   2.20372552e-02,   6.99226881e-02,
          1.73686567e-01,   1.23751241e-01,  -6.28605953e-02,
         -6.64927635e-03,  -2.16861395e-03,   5.70786365e-02,
          1.01527195e-02,   2.87409908e-02,  -4.37065929e-02,
          2.46238869e-02,  -4.78981062e-04,   2.42063067e-01,
          1.76351266e-02,   4.79779470e-01,  -1.59732588e-03,
         -1.44863122e-01,  -1.54013984e-01,  -3.58481333e-04,
         -1.93965349e-01,   3.46465695e-01,   2.84869263e-02,
         -3.44871940e-02,   2.66158454e-01,   3.78767218e-03,
          1.31215724e-02,   3.43477971e-01,   2.20726497e-02,
          1.39647920e-01,   2.89729350e-01,   3.27739954e-02,
         -1.21541222e-01,  -9.40138799e-02,  -5.43952199e-02,
          8.43470877e-03,   4.80058845e-02,   1.42888654e-01,
          3.79172920e-01,   1.97829432e-02,  -1.01409835e-01,
          5.29400475e-02,   2.73867210e-01,  -1.83576922e-03,
          2.07193918e-01,   3.84363974e-01,  -2.73947989e-03,
         -2.44295602e-01,   5.06011563e-01,  -1.37751030e-03,
          4.70120503e-03,   2.23961042e-02,   2.55368804e-02,
          3.95946119e-02,   4.03331406e-01,   5.00020434e-01,
          2.26018937e-01,   4.53766079e-02,   1.29052068e-01,
         -1.30206298e-01,  -2.18351907e-01,  -2.15198047e-01,
          1.81990465e-01,   9.99914522e-03,  -4.19719736e-03,
         -7.29555265e-02,  -2.88055762e-01,   5.20151182e-01,
         -1.88987126e-01,  -1.91635594e-01,   1.51764006e-02,
          2.68714876e-02,   4.39546442e-02,   2.24552353e-01,
          3.47081577e-01,   6.09241390e-01,   3.18685699e-02,
         -8.37220187e-02,   5.70804937e-03,   8.55098739e-02,
         -3.16661917e-01,   1.93258069e-02,  -1.58994705e-02,
          1.07587132e-01,   2.18309546e-01,   9.42877593e-04,
          5.17388506e-01],
       [ -4.95072766e-01,   2.40257232e-01,  -2.68627433e-01,
          4.29436878e-01,  -5.16984881e-01,   4.37707022e-01,
         -4.50684515e-01,   3.84158490e-01,   3.53873922e-01,
         -3.27901045e-01,   2.57834827e-01,   4.68440795e-01,
         -1.07860008e-01,   3.48492513e-01,   1.19172679e-01,
         -7.06960305e-02,   5.54004999e-02,   1.25809174e-01,
          1.11755661e-01,   2.96471416e-01,   5.11665561e-02,
          1.46400279e-01,   3.29245572e-01,   8.42578248e-02,
          1.91661680e-01,   2.21088354e-01,  -1.70646681e-01,
          2.36635318e-01,  -3.73598280e-01,   4.49365447e-01,
          2.99650537e-01,   3.49554702e-01,   2.98652728e-01,
          3.87923431e-01,  -1.88730266e-01,   1.76110717e-01,
          2.92457881e-01,  -1.47530079e-01,   3.21695699e-01,
          3.50258800e-01,  -2.76356766e-01,   2.90148948e-01,
         -9.03233346e-04,  -2.00122967e-01,   3.21139185e-01,
          2.14088497e-01,   5.18530649e-01,   4.71403827e-01,
          4.55279579e-01,  -2.87121834e-02,  -9.69341466e-02,
         -2.38837708e-01,   3.49685179e-01,   6.36627264e-01,
          7.71442764e-02,  -1.49155940e-01,   4.44200746e-01,
         -2.60898846e-02,  -3.24702038e-01,   5.28946641e-01,
          4.76205576e-01,  -3.46605407e-01,   4.29245064e-01,
          5.27651864e-01,   1.65450093e-01,   2.92747278e-01,
          1.86331740e-01,  -2.75744372e-01,  -3.68176712e-01,
          5.71925337e-03,   4.42054668e-03,   4.22796169e-02,
          2.58796680e-01,   4.34093030e-01,   4.26539918e-01,
         -1.15308373e-01,   2.29187590e-01,   6.40154677e-01,
          6.22672152e-01,   5.29940823e-01,  -4.26600254e-01,
          3.63102504e-01,   4.66750953e-01,   2.37751442e-01,
          2.53339910e-01,   1.86913868e-01,  -1.25881643e-01,
         -2.36823632e-01,  -4.45097865e-01,   3.19373145e-01,
          4.77845599e-01,   3.74428455e-01,  -5.97975209e-02,
          6.06157188e-01,   1.82929378e-01,   8.99211281e-02,
          3.47364870e-03,  -1.81384818e-01,   1.17715653e-01,
         -3.86561238e-01],
       [ -7.07721037e-02,   1.14475708e-03,  -4.94159694e-02,
         -3.76957705e-02,  -9.07739182e-02,  -1.87585902e-02,
         -5.88605513e-02,   6.58136376e-03,   3.55357331e-03,
         -5.94209346e-02,  -3.18342705e-03,   5.27084171e-03,
         -5.14432091e-02,   6.37031463e-03,  -2.96942868e-02,
         -3.78927525e-02,  -1.34184435e-02,  -7.81151800e-03,
          3.48452612e-03,   1.12539322e-02,  -1.98254302e-02,
          9.79172601e-03,  -6.50352425e-03,  -4.92544564e-03,
         -6.86194988e-04,   2.39940124e-02,  -2.49855563e-02,
          2.06946403e-03,  -5.00061052e-02,   1.00140676e-02,
         -4.35957268e-02,  -6.88396888e-02,   3.99981449e-03,
         -5.61124089e-02,  -5.02301859e-02,  -2.44320303e-06,
          1.12827928e-02,  -2.82222398e-02,   8.58432674e-03,
          1.31134184e-02,  -3.60845009e-02,   2.72436542e-03,
         -2.87462687e-02,  -2.63176943e-02,  -2.80097605e-03,
          1.34245122e-03,  -4.24678116e-02,   1.04091834e-02,
          2.84575372e-03,   1.45795706e-02,  -1.55778292e-02,
         -4.12137430e-02,   6.83684358e-03,  -4.36617145e-03,
          3.31183803e-03,  -3.07793059e-02,   7.75302448e-03,
         -3.08540310e-02,  -3.72959860e-02,   3.83384309e-03,
         -3.78334246e-02,  -5.94041106e-02,   1.03906803e-02,
          1.25876043e-03,   2.10830025e-03,  -9.56672463e-03,
         -1.04540041e-02,  -3.60468393e-02,  -6.11207300e-02,
         -5.55137869e-02,   1.89733900e-03,  -1.92813556e-02,
         -3.16877380e-02,  -4.22339806e-02,  -4.88825612e-02,
         -1.51101290e-02,   9.99191514e-03,  -7.96136749e-03,
          2.63757347e-03,  -4.13621568e-02,  -4.38123384e-02,
         -3.64308146e-02,  -8.82360557e-02,  -1.86172054e-05,
         -1.40889126e-02,   1.40843384e-03,  -2.07699079e-02,
         -4.71014433e-02,  -7.48726054e-02,  -7.71161674e-03,
         -3.86583533e-02,   5.70089244e-03,   1.30859502e-02,
         -4.66831470e-02,   6.56436316e-03,  -5.18584306e-03,
         -1.73292481e-02,  -2.66131186e-04,   2.88360041e-04,
         -4.96364841e-02],
       [ -3.96639956e-01,   2.39557344e-01,  -2.02944502e-01,
          4.62711199e-01,  -3.96430923e-01,   4.07640566e-01,
         -3.66077464e-01,   3.58031922e-01,   3.32713338e-01,
         -2.56651106e-01,   2.63345516e-01,   4.26695023e-01,
         -4.66884727e-02,   3.37112579e-01,   1.46158492e-01,
         -2.64265269e-02,   7.96500326e-02,   1.23978424e-01,
          1.02891109e-01,   2.77129128e-01,   7.39619012e-02,
          1.33938575e-01,   3.27558690e-01,   9.10376790e-02,
          1.84885003e-01,   1.93915659e-01,  -1.30756843e-01,
          2.33875146e-01,  -3.02985037e-01,   4.14266841e-01,
          3.28646426e-01,   3.74985471e-01,   2.75459986e-01,
          3.99260375e-01,  -1.35564817e-01,   1.76062521e-01,
          2.68928121e-01,  -1.05533686e-01,   3.03314653e-01,
          3.27828192e-01,  -2.26057085e-01,   2.85251018e-01,
          2.47219550e-02,  -1.58603671e-01,   3.17425951e-01,
          2.18140889e-01,   5.02207120e-01,   4.33002811e-01,
          4.33119043e-01,  -2.93153276e-02,  -8.09997070e-02,
         -1.82840886e-01,   3.29940334e-01,   5.83569820e-01,
          8.49268794e-02,  -1.09453298e-01,   4.11278119e-01,
          9.99903158e-03,  -2.73272737e-01,   5.07065198e-01,
          4.89005099e-01,  -2.55594348e-01,   3.94708772e-01,
          5.09630534e-01,   1.60022289e-01,   3.01855319e-01,
          1.90821552e-01,  -2.15003245e-01,  -2.84252990e-01,
          6.45367300e-02,   7.41690934e-03,   7.23471131e-02,
          2.78068638e-01,   4.51874311e-01,   4.64247246e-01,
         -8.55347856e-02,   2.09919939e-01,   6.08538920e-01,
          5.86061579e-01,   5.64668264e-01,  -3.53824836e-01,
          3.88125224e-01,   4.86887687e-01,   2.36102218e-01,
          2.63839896e-01,   1.88708211e-01,  -9.46663698e-02,
         -1.74150363e-01,  -3.45330593e-01,   3.12054979e-01,
          4.61590321e-01,   3.41157957e-01,  -5.72793054e-02,
          6.29478134e-01,   1.80781341e-01,   8.52175392e-02,
          2.94800840e-02,  -1.57244724e-01,   1.19425192e-01,
         -3.04690041e-01]]
b_input_hidden=[[ 0.04567362, -0.00120271,  0.0167946 ,  0.05139045,  0.05120464,
         0.05447804,  0.03325854, -0.00658845,  0.04164239,  0.02030256,
        -0.007208  ,  0.05490047,  0.00451237, -0.0220238 , -0.02080712,
         0.0043794 , -0.01102652,  0.0186135 ,  0.00837355,  0.01734561,
        -0.01234228, -0.00345219, -0.02223301,  0.01191597, -0.02394038,
         0.00384483,  0.01236278, -0.0153455 ,  0.0312131 ,  0.01276547,
         0.05811161,  0.06888632,  0.00287593,  0.06658877,  0.00423328,
        -0.02848312,  0.03011905,  0.01261109, -0.00379057, -0.01312457,
         0.02214079, -0.02206544, -0.00530041,  0.02023191, -0.02996814,
         0.027379  ,  0.06792355,  0.04614308, -0.00301387,  0.00868717,
         0.00296953,  0.01456358, -0.01895738,  0.07762911, -0.01542171,
         0.00879962,  0.01469419, -0.00049438,  0.0236639 ,  0.0219026 ,
         0.07932855,  0.03790877,  0.0110322 , -0.00274763, -0.02063985,
        -0.0159744 , -0.0243867 ,  0.02299332,  0.03462742, -0.00992025,
        -0.00527312, -0.00909468,  0.04403822,  0.07668676,  0.07710093,
         0.00359246, -0.00999233,  0.04569397,  0.06712149,  0.07968528,
         0.02948829,  0.055113  ,  0.0880124 , -0.0151587 , -0.01278604,
        -0.02851629,  0.00702957,  0.01379382,  0.03888838, -0.02415241,
         0.06313979, -0.00569845,  0.01630604,  0.0978599 , -0.01924877,
         0.01065343, -0.00781909,  0.03067056,  0.00088692,  0.04296362]]
w_hidden_output=[[ -7.01159930e-01,  -1.42049893e-01,   1.20074506e-01,
          3.17792909e-01,   4.21747978e-01],
       [  1.37399785e-01,   1.42263631e-01,   9.81404686e-02,
         -9.14189005e-02,  -2.61701136e-01],
       [ -4.23075409e-01,  -5.50807380e-02,   1.03539248e-01,
          2.00709172e-01,   2.06285503e-01],
       [  5.34900279e-01,   1.59944533e-01,  -4.21756760e-01,
         -1.64713165e-01,  -8.80505418e-02],
       [ -7.70527910e-01,  -1.16863363e-01,   1.44848411e-01,
          3.40142466e-01,   4.27675196e-01],
       [  3.67963943e-01,   2.41090586e-01,  -5.84887095e-03,
         -4.03834637e-01,  -1.77831705e-01],
       [ -6.07219271e-01,  -1.45653701e-01,   9.22870248e-02,
          2.93191425e-01,   3.82497972e-01],
       [  2.35734430e-01,   1.96251007e-01,   1.41106363e-01,
         -1.42918948e-01,  -4.13740940e-01],
       [  2.60603480e-01,   1.99699105e-01,   5.12376238e-02,
         -3.35192765e-01,  -1.60554287e-01],
       [ -5.02470500e-01,  -8.03400479e-02,   1.09121610e-01,
          2.37555548e-01,   2.58295353e-01],
       [  1.51067578e-01,   1.43094571e-01,   1.04739090e-01,
         -6.10328601e-02,  -3.22090027e-01],
       [  3.51193588e-01,   2.55099515e-01,   6.31907690e-02,
         -4.40554828e-01,  -2.00125874e-01],
       [ -2.42012322e-01,   2.78354961e-02,   8.54726339e-02,
          1.10855359e-01,   4.04698938e-02],
       [  2.10448376e-01,   1.64336898e-01,   1.54719884e-01,
         -5.46521153e-02,  -4.48758362e-01],
       [  2.73729456e-02,   8.17288432e-02,   8.39969093e-02,
          4.35626430e-02,  -2.20575549e-01],
       [ -1.62326643e-01,   2.84820174e-02,   6.06922994e-02,
          7.54283371e-02,   2.93710247e-02],
       [ -5.17400488e-02,   5.86119537e-02,   9.67235090e-02,
          3.69460699e-02,  -1.20621117e-01],
       [  1.43408155e-01,   3.61949934e-02,  -1.27594576e-01,
         -2.25541279e-02,  -1.01511536e-02],
       [  6.31597181e-02,   7.26988245e-02,   4.19423794e-02,
         -8.94239864e-02,  -6.56500350e-02],
       [  2.11589673e-01,   1.61416108e-01,   7.20456281e-02,
         -1.60115443e-01,  -2.67577327e-01],
       [ -3.63071275e-03,   4.84041910e-02,   5.16479990e-02,
          3.50247740e-02,  -1.08983297e-01],
       [  8.26633505e-02,   7.72890134e-02,   6.67797806e-02,
         -5.60448395e-02,  -1.49491714e-01],
       [  1.84840045e-01,   1.65206321e-01,   1.43815349e-01,
         -4.30672421e-02,  -4.39145889e-01],
       [  1.01818012e-01,   3.07239780e-02,  -8.61560654e-02,
         -1.68369082e-02,  -7.98701764e-03],
       [  1.05612480e-01,   8.35789130e-02,   9.94824451e-02,
          3.76355097e-03,  -2.71959561e-01],
       [  1.45701319e-01,   1.02921988e-01,   8.06208213e-02,
         -1.06296372e-01,  -2.07286522e-01],
       [ -2.60876467e-01,  -4.07476543e-02,   6.00444201e-02,
          1.18018127e-01,   1.36480945e-01],
       [  1.38653037e-01,   1.16945313e-01,   1.05389450e-01,
         -3.64743857e-02,  -3.08083649e-01],
       [ -5.31201884e-01,  -1.08332527e-01,   1.00841551e-01,
          2.45712446e-01,   3.20802169e-01],
       [  2.97966071e-01,   2.38549453e-01,   1.34412657e-01,
         -2.08954815e-01,  -4.38011096e-01],
       [  3.39288790e-01,   1.36618459e-01,  -3.11337017e-01,
         -8.65705954e-02,  -5.31708615e-02],
       [  4.26999821e-01,   1.77445612e-01,  -3.12037794e-01,
         -1.82081410e-01,  -8.98304928e-02],
       [  1.98254604e-01,   1.56499336e-01,   9.52356824e-02,
         -1.21859304e-01,  -3.04512524e-01],
       [  4.50440257e-01,   1.66195533e-01,  -3.57687533e-01,
         -1.53896990e-01,  -8.28875688e-02],
       [ -3.50101449e-01,  -2.18450195e-02,   1.07348021e-01,
          1.65120322e-01,   1.21141697e-01],
       [  1.05419597e-01,   6.73403327e-02,   9.63978243e-02,
          4.00531269e-02,  -2.84037726e-01],
       [  1.96282262e-01,   1.68032236e-01,   7.19444577e-02,
         -2.59895719e-01,  -1.54786805e-01],
       [ -2.69493931e-01,  -1.28009301e-02,   8.39188778e-02,
          1.11380688e-01,   1.13063822e-01],
       [  2.05284428e-01,   1.62277817e-01,   1.16596749e-01,
         -1.17057440e-01,  -3.51393378e-01],
       [  2.18076207e-01,   1.64729890e-01,   1.43090439e-01,
         -9.94807899e-02,  -4.06891333e-01],
       [ -3.82841060e-01,  -8.29131177e-02,   6.72073874e-02,
          1.82535315e-01,   2.38990538e-01],
       [  1.74440185e-01,   1.34855742e-01,   1.32411735e-01,
         -3.09078829e-02,  -3.89948678e-01],
       [ -1.01282309e-01,   3.92964709e-02,   7.28232261e-02,
          5.38925934e-02,  -5.35556266e-02],
       [ -3.10986367e-01,  -4.69817563e-02,   7.30821863e-02,
          1.30162175e-01,   1.73663705e-01],
       [  1.82118323e-01,   1.49325982e-01,   1.49359437e-01,
         -1.60265787e-02,  -4.49396049e-01],
       [  2.60932889e-01,   3.80775139e-02,  -2.29294931e-01,
         -2.84423898e-02,  -1.15043763e-02],
       [  4.65044233e-01,   2.94181362e-01,  -7.28156393e-02,
         -4.77506941e-01,  -1.93019836e-01],
       [  3.40697733e-01,   2.67230218e-01,   9.11342969e-02,
         -3.83323551e-01,  -2.88628546e-01],
       [  2.81640969e-01,   2.41028327e-01,   1.62366621e-01,
         -1.68258002e-01,  -4.96482663e-01],
       [ -4.18590022e-02,  -1.22473817e-02,   2.24407259e-02,
          1.17883763e-02,   4.35816313e-02],
       [ -1.50362430e-01,  -2.78865411e-02,   3.76949126e-02,
          7.52806949e-02,   7.84618998e-02],
       [ -3.97870744e-01,  -5.03245772e-02,   1.06378056e-01,
          1.78499426e-01,   1.80165982e-01],
       [  2.08473901e-01,   1.64013118e-01,   1.50748293e-01,
         -6.85421960e-02,  -4.34195203e-01],
       [  4.92356434e-01,   3.48201486e-01,   5.27160659e-02,
         -5.96962934e-01,  -2.73103625e-01],
       [  1.87985664e-02,   4.11697520e-02,   7.46712808e-02,
          2.41474753e-02,  -1.29424501e-01],
       [ -2.74438490e-01,  -1.49224692e-02,   9.01580881e-02,
          1.21347317e-01,   1.09884562e-01],
       [  2.98829320e-01,   2.38060002e-01,   1.27314333e-01,
         -2.09941149e-01,  -4.29715996e-01],
       [ -1.64457151e-01,   4.76654685e-02,   1.02743383e-01,
          6.87199704e-02,  -2.99952321e-02],
       [ -4.34088898e-01,  -1.11049536e-01,   6.88076941e-02,
          2.07729071e-01,   2.87957594e-01],
       [  3.43836166e-01,   3.02375045e-01,   1.52283030e-01,
         -2.66951237e-01,  -5.11273184e-01],
       [  5.43695558e-01,   1.40597861e-01,  -5.03415462e-01,
         -1.00054492e-01,  -5.45020917e-02],
       [ -5.47207172e-01,  -6.31434595e-02,   1.22188775e-01,
          2.24262884e-01,   2.84823297e-01],
       [  2.79699172e-01,   2.26428065e-01,   1.31362380e-01,
         -1.99584567e-01,  -4.20798741e-01],
       [  3.37416721e-01,   2.79828292e-01,   1.81786904e-01,
         -1.81112285e-01,  -5.92015091e-01],
       [  9.06499226e-02,   7.71383420e-02,   9.13318955e-02,
         -4.58638145e-05,  -2.26701211e-01],
       [  1.75633656e-01,   1.55276757e-01,   1.25291195e-01,
         -2.46926628e-02,  -4.01802299e-01],
       [  9.04965953e-02,   9.44257404e-02,   1.06319938e-01,
          1.66634896e-02,  -2.79264205e-01],
       [ -4.29795456e-01,  -6.43581641e-02,   1.06052267e-01,
          1.86328838e-01,   2.31169243e-01],
       [ -5.52107340e-01,  -8.89705034e-02,   1.05023855e-01,
          2.40966455e-01,   3.03237211e-01],
       [ -1.57976694e-01,   7.82436359e-02,   1.17575441e-01,
          9.32139884e-02,  -1.12912094e-01],
       [ -2.41266352e-02,   8.17845382e-03,   3.52429389e-02,
          1.89471894e-02,  -1.69781321e-02],
       [ -6.44903696e-02,   5.97011098e-02,   9.06031260e-02,
          3.98115865e-02,  -1.07269449e-01],
       [  3.01684326e-01,   1.06801808e-01,  -2.61055764e-01,
         -8.21012930e-02,  -3.86146000e-02],
       [  4.90830052e-01,   1.46054289e-01,  -4.59204724e-01,
         -1.03525925e-01,  -5.14095925e-02],
       [  4.90196339e-01,   1.71976974e-01,  -4.46866193e-01,
         -1.26237480e-01,  -6.58588000e-02],
       [ -1.85367168e-01,  -2.38893360e-02,   5.64592648e-02,
          9.06688160e-02,   8.75112995e-02],
       [  1.42429341e-01,   1.04233027e-01,   9.68324704e-02,
         -6.07077188e-02,  -2.65157474e-01],
       [  4.53841729e-01,   3.70412031e-01,   1.33094581e-01,
         -3.43985386e-01,  -5.86346837e-01],
       [  4.47735728e-01,   3.62675826e-01,   1.08197043e-01,
         -5.34672218e-01,  -3.63320387e-01],
       [  6.40318917e-01,   1.84460767e-01,  -5.37519005e-01,
         -1.69817526e-01,  -9.59761134e-02],
       [ -5.81084478e-01,  -1.43482709e-01,   1.06974606e-01,
          2.78844174e-01,   3.68055455e-01],
       [  4.36331829e-01,   1.45538548e-01,  -3.50551155e-01,
         -1.30119694e-01,  -6.80665391e-02],
       [  5.37327321e-01,   2.67096433e-01,  -3.39393515e-01,
         -2.91371916e-01,  -1.43126062e-01],
       [  1.45103283e-01,   1.19379132e-01,   1.03367830e-01,
         -3.09441670e-02,  -3.11605554e-01],
       [  1.39864912e-01,   1.41736013e-01,   1.08067881e-01,
         -2.93949323e-02,  -3.45577046e-01],
       [  8.78467591e-02,   8.32867278e-02,   1.13242094e-01,
          1.25722102e-02,  -2.80709439e-01],
       [ -2.24215060e-01,  -1.81334127e-02,   7.51366968e-02,
          9.99285890e-02,   9.83807224e-02],
       [ -3.72126812e-01,  -4.85202037e-02,   8.50056992e-02,
          1.75515546e-01,   1.74949548e-01],
       [ -6.67504850e-01,  -1.06788386e-01,   1.34394229e-01,
          2.99009502e-01,   3.66780803e-01],
       [  1.79534737e-01,   1.54100351e-01,   1.44070276e-01,
         -2.50010164e-02,  -4.35192210e-01],
       [  4.18705867e-01,   2.78552338e-01,  -5.15863488e-02,
         -4.45061556e-01,  -1.67468791e-01],
       [  2.41899869e-01,   1.79353471e-01,   1.35129591e-01,
         -1.19834670e-01,  -4.14028370e-01],
       [ -8.92154913e-02,  -2.24525012e-02,   2.91130209e-02,
          3.06796801e-02,   6.87464093e-02],
       [  7.03827508e-01,   1.92278350e-01,  -6.25804589e-01,
         -1.62293431e-01,  -9.14976759e-02],
       [  1.04867786e-01,   8.51852151e-02,   9.46140262e-02,
         -1.47208574e-02,  -2.46059704e-01],
       [  8.17892539e-02,   5.06955532e-02,  -7.43356048e-03,
         -8.06075177e-02,  -3.19994774e-02],
       [ -6.75146239e-02,   3.41867141e-02,   6.64116259e-02,
          4.81446100e-02,  -4.97390684e-02],
       [ -2.42970331e-01,  -6.32165073e-02,   4.27839479e-02,
          1.06088999e-01,   1.76821053e-01],
       [  7.91220973e-02,   7.25412907e-02,   4.21299273e-02,
         -4.46301424e-02,  -1.24114122e-01],
       [ -5.68949032e-01,  -9.78224683e-02,   1.12753927e-01,
          2.39240159e-01,   3.39797378e-01]]
b_hidden_output=[[ 0.13735827,  0.40480946, -0.12836552, -0.42175138,  0.00794917]]

Features_Num=5
Class_Num=5
Learning_Rate=1e-2
Hidden_Size=100
Reg=1e-3

class SoftMax_Classifier:
    def __init__(self, hidden_size=Hidden_Size, class_num=Class_Num, features_num=Features_Num,
                 learning_rate=Learning_Rate, reg=Reg):

        import numpy as np
        #print(features_num, hidden_size)
        self.w_input_hidden = w_input_hidden#0.01 * np.random.rand(features_num, hidden_size)
        self.b_input_hidden = b_input_hidden#np.zeros((1, hidden_size))
        self.w_hidden_output =w_hidden_output# 0.01 * np.random.rand(hidden_size, class_num)
        self.b_hidden_output = b_hidden_output#np.zeros((1, class_num))
        self.learning_rate = learning_rate
        self.reg = reg

    def test(self, input_data):

        #cpu io
        io_weight= input_data[0] * terasort_IO_Measure_Weight + input_data[1] * testdfsio_IO_Measure_Weight + input_data[2] * tpcds_IO_Measure_Weight + input_data[3] * spark_IO_Measure_Weight + input_data[4] * kmeans_IO_Measure_Weight  # IO
        cpu_weight= input_data[0] * terasort_CPU_Measure_Weight + input_data[1] * testdfsio_CPU_Measure_Weight + input_data[2] * tpcds_CPU_Measure_Weight + input_data[3] * spark_CPU_Measure_Weight + input_data[4] * kmeans_CPU_Measure_Weight  # CPU
        total_weight=io_weight+cpu_weight
        io_weight=io_weight/total_weight
        cpu_weight=cpu_weight/total_weight

        hidden_output = np.maximum(0, np.dot(input_data, self.w_input_hidden) + self.b_input_hidden)
        result = np.dot(hidden_output, self.w_hidden_output) + self.b_hidden_output  # data_num*class_num

        result = np.exp(result)
        result = result / np.sum(result, axis=1, keepdims=True)  # data_num*class_num
        #print(result)
        return (io_weight,cpu_weight),result.argmax(axis=1)[0]

softmax=SoftMax_Classifier()
print(softmax.test([1, 3, 1, 1, 0]))
